<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>בעיות קיצון (חדו"א) | שאלון 35382 | פלטפורמת למידה במתמטיקה</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    
    
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Assistant', sans-serif;
            background-color: #f9fafb; /* bg-gray-50 */
        }
        .formula-box {
            background-color: #E5E7EB; /* bg-gray-200 */
            padding: 0.75rem; 
            border-radius: 0.375rem; /* rounded-md */
            display: inline-block; 
            font-size: 1.125em; /* text-lg */
            line-height: 1.5; 
            margin: 0.25rem 0.1rem;
            vertical-align: middle;
        }
        .formula-box-block {
             background-color: #f3f4f6; /* bg-gray-100 for block */
             padding: 1rem;
             border-radius: 0.375rem;
             display: block;
             font-size: 1.2em;
             margin: 1rem 0;
             text-align: center;
             border: 1px solid #e5e7eb;
        }
        .formula-box[dir="ltr"] .math-inline { text-align: left !important; }
        #notification-box {
            transition: opacity 0.5s ease-in-out;
        }
        .solution {
            background-color: #f0e6ff; /* Lighter purple for solution */
            border: 1px solid #d8b4fe; /* purple-300 for border */
        }
        .feedback.bg-green-100 { border: 1px solid #a7f3d0; }
        .feedback.bg-red-100 { border: 1px solid #fecaca; }
        .feedback.bg-yellow-100 { border: 1px solid #fde68a; }
        .math-display { text-align: center; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

<div id="notification-box" class="fixed top-5 right-5 text-white p-4 rounded-lg shadow-xl hidden z-50 max-w-sm text-right">
הודעה תוצג כאן
</div>

<div class="container mx-auto p-4 md:p-8 max-w-5xl">
<header class="mb-8">
    <nav aria-label="breadcrumb" class="text-sm text-gray-600 mb-2">
<ol class="list-none p-0 inline-flex">
<li class="flex items-center">
<a href="index.html" class="hover:underline">דף ראשי</a>
<svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
</li>
<li class="flex items-center">
<a href="questionnaire_35382_lessons_he.html" id="breadcrumb-questionnaire" class="hover:underline">שאלון 35382</a>
           <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
</li>
<li class="flex items-center">
<span id="breadcrumb-main-topic" class="text-gray-700">חשבון דיפרנציאלי ואינטגרלי (חדו"א)</span>
<svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
</li>
<li class="flex items-center">
<span id="breadcrumb-lesson-name" class="text-gray-500">בעיות קיצון</span>
</li>
</ol>
</nav>
<h1 id="lesson-title" class="text-3xl md:text-4xl font-bold text-purple-700">בעיות קיצון (חדו"א) 🏆</h1>
</header>

<main class="bg-white p-6 md:p-8 rounded-lg shadow-lg">

    <section id="learn" aria-labelledby="learn-heading" class="mb-12">
        <h2 id="learn-heading" class="text-2xl font-semibold text-purple-600 mb-4 border-b-2 border-purple-200 pb-2">לומדים: פתרון בעיות ערך קיצון (אופטימיזציה)</h2>
        <div class="space-y-4 text-gray-700 leading-relaxed">
            <p>בעיות קיצון (או בעיות אופטימיזציה) הן בעיות בהן אנו מחפשים למצוא את הערך המקסימלי או המינימלי של גודל מסוים (למשל, שטח, נפח, רווח, מרחק) תחת אילוצים נתונים. חשבון דיפרנציאלי (ובפרט, הנגזרת) הוא כלי מרכזי בפתרון בעיות אלו.</p>
            
            <h3 class="text-xl font-semibold mt-6 mb-2 text-gray-800">1. שלבי פתרון כלליים לבעיות קיצון</h3>
            <ol class="list-decimal pr-6 space-y-2">
                <li><strong>הבנת הבעיה:</strong> קרא בעיון את הבעיה. זהה מהו הגודל שיש למצוא לו ערך קיצון (מקסימום או מינימום) ומהם האילוצים או התנאים הנתונים.</li>
                <li><strong>הגדרת משתנים:</strong> סמן את הגדלים המשתנים בבעיה באמצעות משתנים (למשל <span class="formula-box" dir="ltr">\(x, y\)</span>).</li>
                <li><strong>בניית פונקציית מטרה:</strong> בטא את הגודל שיש למצוא לו ערך קיצון כפונקציה של המשתנים שהגדרת. זוהי "פונקציית המטרה".</li>
                <li><strong>שימוש באילוצים (במידת הצורך):</strong> אם פונקציית המטרה תלויה ביותר ממשתנה אחד, השתמש באילוצים הנתונים בבעיה כדי לבטא את אחד המשתנים באמצעות האחרים, כך שפונקציית המטרה תהיה תלויה במשתנה אחד בלבד.</li>
                <li><strong>קביעת תחום הגדרה:</strong> קבע את תחום ההגדרה של פונקציית המטרה (במשתנה יחיד) בהתאם למגבלות הפיזיקליות או הגיאומטריות של הבעיה (למשל, אורכים חייבים להיות חיוביים).</li>
                <li><strong>מציאת נקודות חשודות לקיצון:</strong> גזור את פונקציית המטרה והשווה את הנגזרת לאפס (<span class="formula-box" dir="ltr">\(f'(x)=0\)</span>) כדי למצוא נקודות קריטיות (חשודות לקיצון).</li>
                <li><strong>סיווג הנקודות ובדיקת קצוות:</strong>
                    <ul class="list-disc pr-6 space-y-1 mt-1">
                        <li>סווג את הנקודות הקריטיות שמצאת (מינימום, מקסימום) באמצעות נגזרת שנייה או טבלת ערכים.</li>
                        <li>אם תחום ההגדרה הוא קטע סגור, חשב את ערך פונקציית המטרה גם בנקודות הקצה של התחום.</li>
                    </ul>
                </li>
                <li><strong>קביעת ערך הקיצון המוחלט:</strong> השווה את ערכי הפונקציה בנקודות הקיצון המקומיות ובנקודות הקצה (אם רלוונטי) כדי למצוא את הערך המקסימלי או המינימלי המוחלט המבוקש.</li>
                <li><strong>תשובה מילולית:</strong> ענה על השאלה המקורית בבעיה.</li>
            </ol>

            <h3 class="text-xl font-semibold mt-8 mb-2 text-gray-800">דוגמה פתורה (ממסמך המחקר)</h3>
            <div class="border border-gray-200 rounded-lg p-4 bg-gray-50 space-y-3 my-6">
                <p class="font-medium"><strong>דוגמה:</strong> סכומם של שני מספרים חיוביים הוא 20. מצא את שני המספרים שמכפלתם מקסימלית.</p>
                <p><strong>פתרון:</strong></p>
                <p>1. <strong>הבנת הבעיה:</strong> יש למצוא שני מספרים חיוביים שסכומם 20 כך שמכפלתם תהיה מקסימלית.</p>
                <p>2. <strong>הגדרת משתנים:</strong></p>
                <ul class="list-disc pr-4">
                    <li>נסמן את המספר הראשון ב-<span class="formula-box" dir="ltr">\(x\)</span>.</li>
                    <li>מכיוון שסכום שני המספרים הוא 20, המספר השני יהיה <span class="formula-box" dir="ltr">\(20-x\)</span>.</li>
                </ul>
                <p>3. <strong>בניית פונקציית מטרה:</strong> אנו רוצים למקסם את המכפלה. נסמן את פונקציית המכפלה ב-<span class="formula-box" dir="ltr">\(P(x)\)</span>.</p>
                <div class="formula-box-block" dir="ltr"> P(x) = x \cdot (20-x) = 20x - x^2 </div>
                <p>4. <strong>קביעת תחום הגדרה:</strong> נתון שהמספרים חיוביים.</p>
                <ul class="list-disc pr-4">
                    <li><span class="formula-box" dir="ltr">\(x > 0\)</span></li>
                    <li><span class="formula-box" dir="ltr">\(20-x > 0 \Rightarrow x < 20\)</span></li>
                </ul>
                <p>לכן, תחום ההגדרה הוא <span class="formula-box" dir="ltr">\(0 < x < 20\)</span>.</p>
                <p>5. <strong>מציאת נקודות חשודות לקיצון:</strong> נגזור את <span class="formula-box" dir="ltr">\(P(x)\)</span> ונשווה לאפס.</p>
                <div class="formula-box-block" dir="ltr"> P'(x) = (20x - x^2)' = 20 - 2x </div>
                <div class="formula-box-block" dir="ltr"> P'(x) = 0 \Rightarrow 20 - 2x = 0 \Rightarrow 2x = 20 \Rightarrow x = 10 </div>
                <p>הנקודה <span class="formula-box" dir="ltr">\(x=10\)</span> נמצאת בתחום ההגדרה <span class="formula-box" dir="ltr">\(0 < x < 20\)</span>.</p>
                <p>6. <strong>סיווג הנקודה:</strong> נשתמש בנגזרת שנייה.</p>
                <div class="formula-box-block" dir="ltr"> P''(x) = (20 - 2x)' = -2 </div>
                <p>מכיוון ש-<span class="formula-box" dir="ltr">\(P''(10) = -2 < 0\)</span>, הנקודה <span class="formula-box" dir="ltr">\(x=10\)</span> היא נקודת מקסימום.</p>
                <p>7. <strong>מציאת המספר השני:</strong> אם <span class="formula-box" dir="ltr">\(x=10\)</span>, אז המספר השני הוא <span class="formula-box" dir="ltr">\(20-x = 20-10 = 10\)</span>.</p>
                <p>8. <strong>תשובה מילולית:</strong> שני המספרים שמכפלתם מקסימלית הם 10 ו-10.</p>
            </div>
        </div>
    </section>

    <section id="practice" aria-labelledby="practice-heading" class="mb-12">
        <h2 id="practice-heading" class="text-2xl font-semibold text-purple-600 mb-4 border-b-2 border-purple-200 pb-2">מתרגלים ✍️</h2>
        <div class="space-y-6">
            <div class="exercise p-4 border border-gray-300 rounded-lg bg-gray-50">
                <p class="exercise-question font-medium"><strong>תרגיל 1:</strong> מבין כל המלבנים שהיקפם 40 ס"מ, מהם ממדי המלבן (אורך ורוחב) בעל השטח הגדול ביותר?</p>
                <div class="mt-3">
                    <label for="ex1-length" class="block text-sm font-medium text-gray-700">אורך (ס"מ):</label>
                    <input type="text" id="ex1-length" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-purple-500 focus:border-purple-500 mt-1" placeholder="הכנס אורך">
                     <label for="ex1-width" class="block text-sm font-medium text-gray-700 mt-2">רוחב (ס"מ):</label>
                    <input type="text" id="ex1-width" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-purple-500 focus:border-purple-500 mt-1" placeholder="הכנס רוחב">
                </div>
                <div class="mt-3">
                    <button onclick="checkRectangleDimensions()" class="check-answer-btn bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">בדוק תשובה</button>
                    <button onclick="showSolution('sol1')" class="show-solution-btn bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out ml-2">הצג פתרון</button>
                </div>
                <div id="feedback-ex1" class="feedback hidden mt-3 p-3 rounded-md text-sm"></div>
                <div id="sol1" class="solution hidden mt-3 p-3 border-t border-gray-200 bg-white rounded-md">
                    <p><strong>פתרון מלא:</strong></p>
                    <p>1. נסמן את רוחב המלבן ב-<span class="formula-box" dir="ltr">\(x\)</span> ס"מ ואת אורכו ב-<span class="formula-box" dir="ltr">\(y\)</span> ס"מ.</p>
                    <p>2. <strong>אילוץ (היקף):</strong> <span class="formula-box" dir="ltr">\(2x + 2y = 40 \Rightarrow x+y=20 \Rightarrow y = 20-x\)</span>.</p>
                    <p>3. <strong>פונקציית מטרה (שטח):</strong> <span class="formula-box" dir="ltr">\(A = x \cdot y\)</span>. נציב את האילוץ:</p>
                    <div class="formula-box-block" dir="ltr"> A(x) = x(20-x) = 20x - x^2 </div>
                    <p>4. <strong>תחום הגדרה:</strong> אורכים חייבים להיות חיוביים. <span class="formula-box" dir="ltr">\(x > 0\)</span> וגם <span class="formula-box" dir="ltr">\(y > 0 \Rightarrow 20-x > 0 \Rightarrow x < 20\)</span>. לכן <span class="formula-box" dir="ltr">\(0 < x < 20\)</span>.</p>
                    <p>5. <strong>נגזרת:</strong> <span class="formula-box" dir="ltr">\(A'(x) = 20 - 2x\)</span>.</p>
                    <p>6. <strong>נקודה חשודה:</strong> <span class="formula-box" dir="ltr">\(A'(x) = 0 \Rightarrow 20 - 2x = 0 \Rightarrow x = 10\)</span>.</p>
                    <p>7. <strong>סיווג:</strong> <span class="formula-box" dir="ltr">\(A''(x) = -2 < 0\)</span>, לכן זו נקודת מקסימום.</p>
                    <p>8. <strong>ממדים:</strong> אם <span class="formula-box" dir="ltr">\(x=10\)</span> (רוחב), אז <span class="formula-box" dir="ltr">\(y = 20-10 = 10\)</span> (אורך).</p>
                    <p><strong>תשובה:</strong> המלבן בעל השטח הגדול ביותר הוא ריבוע שצלעו 10 ס"מ. (אורך=10 ס"מ, רוחב=10 ס"מ).</p>
                </div>
            </div>
        </div>
    </section>

    <section id="test-yourself" aria-labelledby="test-heading" class="mb-12">
        <h2 id="test-heading" class="text-2xl font-semibold text-purple-600 mb-4 border-b-2 border-purple-200 pb-2">בחן את עצמך 🧐</h2>
        <form id="quizForm" class="space-y-6">
            <div class="quiz-question p-4 border border-gray-300 rounded-lg bg-gray-50">
                <p class="font-medium"><strong>שאלה 1:</strong> מהו השלב הראשון בפתרון בעיית קיצון לאחר הבנת הבעיה?</p>
                <div class="mt-2 space-y-1">
                    <label class="flex items-center"><input type="radio" name="q1" value="a" class="form-radio text-purple-600 ml-2"> גזירת פונקציית המטרה</label>
                    <label class="flex items-center"><input type="radio" name="q1" value="b" class="form-radio text-purple-600 ml-2"> הגדרת משתנים</label>
                    <label class="flex items-center"><input type="radio" name="q1" value="c" class="form-radio text-purple-600 ml-2"> בדיקת נקודות קצה</label>
                </div>
            </div>
            <div class="quiz-question p-4 border border-gray-300 rounded-lg bg-gray-50">
                <p class="font-medium"><strong>שאלה 2:</strong> אם <span class="formula-box" dir="ltr">\(f'(c)=0\)</span> ו-<span class="formula-box" dir="ltr">\(f''(c)>0\)</span>, אז בנקודה <span class="formula-box" dir="ltr">\(x=c\)</span> יש לפונקציה...</p>
                 <div class="mt-2 space-y-1">
                    <label class="flex items-center"><input type="radio" name="q2" value="a" class="form-radio text-purple-600 ml-2"> מקסימום מקומי</label>
                    <label class="flex items-center"><input type="radio" name="q2" value="b" class="form-radio text-purple-600 ml-2"> מינימום מקומי</label>
                    <label class="flex items-center"><input type="radio" name="q2" value="c" class="form-radio text-purple-600 ml-2"> לא ניתן לקבוע</label>
                </div>
            </div>
            <button type="button" id="submit-quiz" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out">הגש בוחן</button>
        </form>
        <div id="quiz-results" class="hidden mt-3 p-3 rounded-md text-sm"></div>
    </section>

    <section id="progress" aria-labelledby="progress-heading" class="text-center mt-12 py-8">
         
    </section>
<div class="flex justify-center mt-4">
    <button id="mark-done" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-md mr-2">Mark as Done</button>
    <button id="mark-undone" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-md">Mark as Undone</button>
</div></main>

<footer class="text-center text-gray-600 mt-12 py-4 border-t border-gray-300">
    <p>&copy; <span id="current-year"></span> פלטפורמת למידה במתמטיקה. כל הזכויות שמורות.</p>
    <div class="navigation-buttons mt-4">
        <a href="lesson_35382_calculus_polynomial_he.html" class="next-lesson inline-block bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">שיעור הבא</a>
        <a href="index.html" class="back-to-menu inline-block bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out ml-2">חזרה לתפריט השיעורים</a>
    </div>
</footer>
</div>

<script>
const LESSON_ID = 'lesson_35382_calculus_optimization';
const LESSON_TITLE = 'בעיות קיצון (חדו"א)';
const BREADCRUMB_QUESTIONNAIRE_TEXT = 'שאלון 35382';
const BREADCRUMB_QUESTIONNAIRE_LINK = 'questionnaire_35382_lessons_he.html';
const BREADCRUMB_MAIN_TOPIC_TEXT = 'חשבון דיפרנציאלי ואינטגרלי (חדו"א)';

const QUIZ_ANSWERS = { q1: 'b', q2: 'b' }; 

document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body);
    document.getElementById('lesson-title').textContent = LESSON_TITLE + " 🏆";
    document.title = LESSON_TITLE + " | שאלון 35382 | פלטפורמת למידה במתמטיקה";
    
    const breadcrumbQ = document.getElementById('breadcrumb-questionnaire');
    breadcrumbQ.textContent = BREADCRUMB_QUESTIONNAIRE_TEXT;
    breadcrumbQ.href = BREADCRUMB_QUESTIONNAIRE_LINK;
    
    document.getElementById('breadcrumb-main-topic').textContent = BREADCRUMB_MAIN_TOPIC_TEXT; 
    document.getElementById('breadcrumb-lesson-name').textContent = "בעיות קיצון";
    document.getElementById('current-year').textContent = new Date().getFullYear();
    checkLessonStatus();
});

function showNotification(message, type = 'info', duration = 3000) {
    const notificationBox = document.getElementById('notification-box');
    if (!notificationBox) return;
    notificationBox.textContent = message;
    notificationBox.className = 'fixed top-5 right-5 text-white p-4 rounded-lg shadow-xl z-50 max-w-sm text-right'; 
    if (type === 'success') notificationBox.classList.add('bg-green-500');
    else if (type === 'error') notificationBox.classList.add('bg-red-500');
    else notificationBox.classList.add('bg-purple-500'); 
    notificationBox.classList.remove('hidden');
    notificationBox.style.opacity = 1;
    setTimeout(() => {
        notificationBox.style.opacity = 0;
        setTimeout(() => { notificationBox.classList.add('hidden'); }, 500); 
    }, duration);
}

function checkRectangleDimensions() {
    const lengthInput = document.getElementById('ex1-length').value.trim();
    const widthInput = document.getElementById('ex1-width').value.trim();
    const feedbackEl = document.getElementById('feedback-ex1');

    const correctLength = "10";
    const correctWidth = "10";
    
    // Allow for length and width to be swapped by user
    let lengthIsCorrect = (lengthInput === correctLength && widthInput === correctWidth) || (lengthInput === correctWidth && widthInput === correctLength);
    
    if (lengthIsCorrect) {
        feedbackEl.textContent = 'נכון מאוד! כל הכבוד! 👍';
        feedbackEl.className = 'feedback mt-3 p-3 rounded-md text-sm bg-green-100 text-green-700';
    } else {
        feedbackEl.textContent = 'תשובה שגויה. זכור שהמלבן בעל השטח המקסימלי עם היקף נתון הוא ריבוע. נסה שוב או הצג את הפתרון. 🤔';
        feedbackEl.className = 'feedback mt-3 p-3 rounded-md text-sm bg-red-100 text-red-700';
    }
    feedbackEl.classList.remove('hidden');
}


function showSolution(solutionId) {
    const solutionEl = document.getElementById(solutionId);
    if (solutionEl) {
        solutionEl.classList.toggle('hidden');
        if (!solutionEl.classList.contains('hidden')) {
             renderMathInElement(solutionEl);
        }
    }
}

const quizSubmitButton = document.getElementById('submit-quiz');
if (quizSubmitButton) {
    quizSubmitButton.addEventListener('click', function() {
        let score = 0;
        const quizForm = document.getElementById('quizForm');
        const totalQuestions = Object.keys(QUIZ_ANSWERS).length;

        for (const questionKey in QUIZ_ANSWERS) {
            const userAnswer = quizForm.elements[questionKey] ? quizForm.elements[questionKey].value : null;
            if (userAnswer === QUIZ_ANSWERS[questionKey]) {
                score++;
            }
        }
        
        const resultsEl = document.getElementById('quiz-results');
        resultsEl.textContent = `הציון שלך הוא: ${score} מתוך ${totalQuestions}.`;
        if (score === totalQuestions) resultsEl.className = 'mt-3 p-3 rounded-md text-sm bg-green-100 text-green-700';
        else if (score > 0) resultsEl.className = 'mt-3 p-3 rounded-md text-sm bg-yellow-100 text-yellow-700';
        else resultsEl.className = 'mt-3 p-3 rounded-md text-sm bg-red-100 text-red-700';
        resultsEl.classList.remove('hidden');
        
        recordQuizScore(score, totalQuestions);
        showNotification(`הבוחן הוגש! ציון: ${score}/${totalQuestions}`, 'info');
    });
}

const markCompletedButton = document.getElementById('mark-completed');
if (markCompletedButton) {
    markCompletedButton.addEventListener('click', function() { markLessonAsCompleted(); });
}

// Corrected markLessonAsCompleted function
function markLessonAsCompleted() {
    if (!LESSON_ID) { // LESSON_ID for this script block is 'lesson_35382_calculus_optimization'
        console.error("LESSON_ID is not defined for markLessonAsCompleted.");
        showNotification("שגיאה: מזהה שיעור לא מוגדר.", "error");
        return;
    }
    try {
        localStorage.setItem(`lesson_completed_${LESSON_ID}`, 'true'); 
        showNotification('השיעור סומן כהושלם!', 'success');
        
        const buttonToUpdate = document.getElementById('mark-completed'); 
        if (buttonToUpdate) {
            buttonToUpdate.textContent = 'השיעור הושלם 👍';
            buttonToUpdate.classList.remove('bg-indigo-600', 'hover:bg-indigo-700'); 
            buttonToUpdate.classList.add('bg-green-600', 'cursor-not-allowed');
            buttonToUpdate.disabled = true;
        }

        // For consistency, also update the state for the newer buttons if they exist
        // The newer buttons use lessonId = "lesson_35382_calculus_optimization_he" (note the _he suffix)
        const newButtonsStorageKey = "lesson_35382_calculus_optimization_he";
        localStorage.setItem(newButtonsStorageKey, 'done'); 

        const newMarkDoneButton = document.getElementById("mark-done");
        const newMarkUndoneButton = document.getElementById("mark-undone");
        if (newMarkDoneButton) newMarkDoneButton.style.display = 'none';
        if (newMarkUndoneButton) newMarkUndoneButton.style.display = 'inline-block';

    } catch (e) { 
        showNotification("שגיאה בשמירת ההתקדמות.", "error"); 
        console.error("Error in markLessonAsCompleted:", e);
    }
}

function recordQuizScore(score, totalQuestions) {
    if (!LESSON_ID) {
        console.error("LESSON_ID is not defined for recordQuizScore.");
        return;
    }
    try { 
        localStorage.setItem(`lesson_quiz_score_${LESSON_ID}`, JSON.stringify({score, total: totalQuestions, date: new Date().toISOString()})); 
    } catch (e) {
        console.error("Error saving quiz score to localStorage:", e);
    } // Removed extra semicolon from here
}

function renderMathInElement(element) {
    if (window.renderMathInElement && element) {
        window.renderMathInElement(element, {
            delimiters: [
                {left: "\\(", right: "\\)", display: false}, 
                {left: "\\[", right: "\\]", display: true}
            ],
            throwOnError: false
        });
    }
}
</script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const lessonId = "lesson_35382_calculus_optimization_he"; // Specific to this lesson
    const markDoneButton = document.getElementById("mark-done");
    const markUndoneButton = document.getElementById("mark-undone");

    function updateButtons() {
        if (!markDoneButton || !markUndoneButton) return;
        const isDone = localStorage.getItem(lessonId) === "done";
        markDoneButton.style.display = isDone ? "none" : "inline-block";
        markUndoneButton.style.display = isDone ? "inline-block" : "none";
    }

    if (markDoneButton) {
        markDoneButton.addEventListener("click", function() {
            localStorage.setItem(lessonId, "done");
            updateButtons();
            showNotification('השיעור סומן כהושלם!', 'success');
        });
    }

    if (markUndoneButton) {
        markUndoneButton.addEventListener("click", function() {
            localStorage.removeItem(lessonId);
            updateButtons();
            showNotification('השיעור סומן כלא הושלם.', 'info');
        });
    }

    updateButtons();
  });
</script></body>
</html>



