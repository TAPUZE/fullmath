<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>סטטיסטיקה (מבוא) | סטטיסטיקה והסתברות | שאלון 35182</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet"> 
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Assistant', 'Arial', sans-serif; 
            line-height: 1.7;
        }
        .formula-box {
            background-color: #F3F4F6; 
            padding: 0.5rem 0.75rem; 
            border-radius: 0.375rem;
            display: inline-block; 
            font-size: 1.15em; 
            line-height: 1.6; 
            border: 1px solid #E5E7EB; 
            margin: 0.25rem 0;
        }
        .formula-box[dir="ltr"] .katex {
            text-align: left !important; 
        }
        #notification-box {
            transition: opacity 0.5s ease-in-out;
        }
        .example-box { 
            border: 1px solid #DBEAFE; 
            background-color: #EFF6FF; 
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        .solution .example-box { /* For solutions within practice */
             background-color: #F0FDF4;
             border-color: #A7F3D0;
        }
        .sub-section { margin-top: 1.5rem; }
        .data-list {
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.1em;
            padding: 0.5rem;
            background-color: #E0E7FF; /* indigo-100 */
            border: 1px solid #C7D2FE; /* indigo-200 */
            border-radius: 0.25rem;
            text-align: center;
            margin: 0.5rem auto;
            display: inline-block;
        }
        table.frequency-table {
            width: auto;
            min-width: 300px;
            margin: 1rem auto;
            border-collapse: collapse;
        }
        table.frequency-table th, table.frequency-table td {
            border: 1px solid #9CA3AF; /* gray-400 */
            padding: 0.5rem 0.75rem;
            text-align: center;
        }
        table.frequency-table th {
            background-color: #E5E7EB; /* gray-200 */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="notification-box" class="fixed top-5 right-5 text-white p-4 rounded-lg shadow-xl hidden z-50 max-w-sm text-right">
        הודעה תוצג כאן
    </div>

    <div class="container mx-auto p-4 md:p-8">
        <header class="mb-8">
            <nav aria-label="breadcrumb" class="text-sm text-gray-600 mb-2">
                <ol class="list-none p-0 inline-flex">
                    <li class="flex items-center">
                        <a href="index.html" class="hover:underline">דף ראשי</a> <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569 9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
                    </li>
                    <li class="flex items-center">
                        <a href="questionnaire_35182_toc.html" class="hover:underline">שאלון 35182</a> 
                        <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569 9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
                    </li>
                     <li class="flex items-center">
                        <a href="questionnaire_35182_stats_proba_toc.html" class="hover:underline">סטטיסטיקה והסתברות</a> <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569 9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg>
                    </li>
                    <li class="flex items-center">
                        <span class="text-gray-500">סטטיסטיקה (מבוא)</span>
                    </li>
                </ol>
            </nav>
            <h1 id="lesson-title" class="text-3xl md:text-4xl font-bold text-blue-700">סטטיסטיקה (מבוא)</h1>
        </header>

        <main class="bg-white p-6 md:p-8 rounded-lg shadow-lg">

            <section id="learn" aria-labelledby="learn-heading" class="mb-12">
                <h2 id="learn-heading" class="text-2xl font-semibold text-blue-600 mb-6 border-b-2 border-blue-200 pb-2">לומדים 📚</h2>
                <div class="space-y-6 text-gray-700 leading-relaxed">
                    <p>סטטיסטיקה היא תחום במתמטיקה העוסק באיסוף, ארגון, ניתוח, פירוש והצגה של נתונים. היא עוזרת לנו להבין תופעות, להסיק מסקנות ולקבל החלטות.</p>
                    
                    <div class="sub-section">
                        <h3 class="text-xl font-semibold mt-4 mb-2 text-blue-600">מדדי מרכז</h3>
                        <p>מדדי מרכז הם ערכים המנסים לתאר את "מרכז" קבוצת הנתונים, כלומר, ערך טיפוסי או מייצג של הנתונים. המדדים הנפוצים שנלמד הם ממוצע, חציון ושכיח.</p>

                        <h4 class="text-lg font-semibold mt-3 mb-1">1. ממוצע חשבוני (Mean)</h4>
                        <p>הממוצע הוא סכום כל ערכי הנתונים, מחולק במספר הנתונים.</p>
                        <div class="my-2 text-center">
                            <span class="formula-box" dir="ltr">\(\text{ממוצע} = \frac{\text{סכום כל הנתונים}}{\text{מספר הנתונים}}\)</span>
                        </div>

                        <h4 class="text-lg font-semibold mt-3 mb-1">2. חציון (Median)</h4>
                        <p>החציון הוא הערך האמצעי בקבוצת נתונים המסודרת לפי גודל (מהקטן לגדול או מהגדול לקטן).</p>
                        <ul class="list-disc list-inside space-y-1 pr-5">
                            <li>אם מספר הנתונים (<span dir="ltr">\(N\)</span>) הוא <strong>אי-זוגי</strong>, החציון הוא האיבר הנמצא בדיוק באמצע הרשימה המסודרת (האיבר במקום ה-<span class="formula-box" dir="ltr">\(\frac{N+1}{2}\)</span>).</li>
                            <li>אם מספר הנתונים (<span dir="ltr">\(N\)</span>) הוא <strong>זוגי</strong>, החציון הוא הממוצע של שני האיברים האמצעיים ברשימה המסודרת (האיברים במקומות <span class="formula-box" dir="ltr">\(\frac{N}{2}\)</span> ו-<span class="formula-box" dir="ltr">\(\frac{N}{2}+1\)</span>).</li>
                        </ul>

                        <h4 class="text-lg font-semibold mt-3 mb-1">3. שכיח (Mode)</h4>
                        <p>השכיח הוא הערך המופיע הכי הרבה פעמים בקבוצת הנתונים. ייתכן שלקבוצת נתונים יהיה יותר משכיח אחד (אם מספר ערכים מופיעים באותה תדירות מקסימלית), או שלא יהיה שכיח כלל (אם כל הערכים מופיעים פעם אחת).</p>
                    </div>
                    
                    <div class="example-box">
                        <h4 class="text-lg font-semibold mb-1">דוגמה פתורה (מתוך חומר הבחינה):</h4>
                        <p class="font-medium">הציונים של 5 תלמידים הם: <span class="data-list">70, 80, 80, 90, 100</span>. מהו הממוצע, החציון והשכיח?</p>
                        <p class="mt-2"><strong>פתרון:</strong></p>
                        <p><strong>ממוצע:</strong></p>
                        <p><span class="formula-box" dir="ltr">\(\text{ממוצע} = \frac{70+80+80+90+100}{5} = \frac{420}{5} = 84\)</span></p>
                        <p><strong>חציון:</strong></p>
                        <p>הנתונים כבר מסודרים מהקטן לגדול: 70, 80, <strong>80</strong>, 90, 100.</p>
                        <p>יש 5 נתונים (מספר אי-זוגי). האיבר האמצעי (השלישי) הוא 80. לכן, החציון הוא 80.</p>
                        <p><strong>שכיח:</strong></p>
                        <p>הציון המופיע הכי הרבה פעמים הוא 80 (מופיע פעמיים). לכן, השכיח הוא 80.</p>
                    </div>

                    <div class="sub-section">
                         <h3 class="text-xl font-semibold mt-4 mb-2 text-blue-600">חישוב מדדי מרכז מטבלת שכיחויות</h3>
                         <p>טבלת שכיחויות מציגה כל ערך נתון וכמה פעמים הוא מופיע (השכיחות שלו).</p>
                         <h4 class="text-lg font-semibold mt-3 mb-1">דוגמה עם טבלת שכיחויות:</h4>
                         <p>ציוני תלמידים בכיתה מוצגים בטבלה הבאה:</p>
                         <table class="frequency-table">
                            <thead><tr><th>ציון (ערך)</th><th>מספר תלמידים (שכיחות)</th></tr></thead>
                            <tbody>
                                <tr><td>60</td><td>3</td></tr>
                                <tr><td>70</td><td>5</td></tr>
                                <tr><td>80</td><td>8</td></tr>
                                <tr><td>90</td><td>4</td></tr>
                                <tr><td>100</td><td>2</td></tr>
                            </tbody>
                         </table>
                         <p class="mt-2"><strong>ממוצע:</strong> כדי לחשב ממוצע מטבלת שכיחויות, כופלים כל ערך בשכיחות שלו, סוכמים את כל המכפלות, ומחלקים בסך כל השכיחויות (סה"כ התלמידים).</p>
                         <p>סה"כ תלמידים: <span class="formula-box" dir="ltr">\(3+5+8+4+2 = 22\)</span>.</p>
                         <p>סכום (ערך <span dir="ltr">\(\times\)</span> שכיחות): <span class="formula-box" dir="ltr">\((60 \cdot 3) + (70 \cdot 5) + (80 \cdot 8) + (90 \cdot 4) + (100 \cdot 2)\)</span></p>
                         <p><span class="formula-box" dir="ltr">\( = 180 + 350 + 640 + 360 + 200 = 1730\)</span></p>
                         <p>ממוצע: <span class="formula-box" dir="ltr">\(\frac{1730}{22} \approx 78.64\)</span>.</p>
                         <p class="mt-2"><strong>חציון:</strong> יש 22 תלמידים (מספר זוגי). האיברים האמצעיים הם במקומות <span class="formula-box" dir="ltr">\(\frac{22}{2}=11\)</span> ו-<span class="formula-box" dir="ltr">\(11+1=12\)</span>.</p>
                         <ul class="list-disc list-inside pr-5">
                            <li>3 תלמידים קיבלו 60.</li>
                            <li><span dir="ltr">\(3+5=8\)</span> תלמידים קיבלו 70 או פחות.</li>
                            <li><span dir="ltr">\(8+8=16\)</span> תלמידים קיבלו 80 או פחות.</li>
                         </ul>
                         <p>התלמיד ה-11 והתלמיד ה-12 קיבלו שניהם ציון 80. לכן, החציון הוא <span class="formula-box" dir="ltr">\(\frac{80+80}{2} = 80\)</span>.</p>
                         <p class="mt-2"><strong>שכיח:</strong> הציון בעל השכיחות הגבוהה ביותר הוא 80 (8 תלמידים). לכן, השכיח הוא 80.</p>
                    </div>
                </div>
            </section>

            <section id="practice" aria-labelledby="practice-heading" class="mb-12">
                <h2 id="practice-heading" class="text-2xl font-semibold text-blue-600 mb-4 border-b-2 border-blue-200 pb-2">מתרגלים ✍️</h2>
                <div class="space-y-8 mt-6"> 
                    <div class="exercise p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="exercise-question font-medium">תרגיל 1: נתונה רשימת ציונים: <span class="data-list">90, 70, 100, 80, 70, 90, 70</span>.</p>
                        <div class="mt-3">
                            <label for="ex1-mean" class="block text-sm font-medium text-gray-700">ממוצע:</label>
                            <input type="text" id="ex1-mean" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-blue-500 focus:border-blue-500" placeholder="הכנס ממוצע">
                        </div>
                         <div class="mt-3">
                            <label for="ex1-median" class="block text-sm font-medium text-gray-700">חציון:</label>
                            <input type="text" id="ex1-median" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-blue-500 focus:border-blue-500" placeholder="הכנס חציון">
                        </div>
                         <div class="mt-3">
                            <label for="ex1-mode" class="block text-sm font-medium text-gray-700">שכיח:</label>
                            <input type="text" id="ex1-mode" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-blue-500 focus:border-blue-500" placeholder="הכנס שכיח">
                        </div>
                        <div class="mt-3">
                            <button onclick="checkStatsAnswer('ex1', {mean: '80', median: '80', mode: '70'})" class="check-answer-btn bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">בדוק תשובה</button>
                            <button onclick="showSolution('sol1')" class="show-solution-btn bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-md ml-2">הצג פתרון</button>
                        </div>
                        <div id="feedback-ex1" class="feedback hidden"></div>
                        <div id="sol1" class="solution hidden solution-box">
                            <p><strong>פתרון מלא:</strong></p>
                            <p>סכום הציונים: <span class="formula-box" dir="ltr">\(90+70+100+80+70+90+70 = 570\)</span>. מספר הציונים: 7.</p>
                            <p>ממוצע: <span class="formula-box" dir="ltr">\(\frac{570}{7} \approx 81.43\)</span> (אך אם נדרש מספר שלם, ייתכן שהכוונה הייתה למספרים שסכומם מתחלק. נבדוק שוב את הנתונים. אם התשובה היא 80, הסכום צריך להיות 560. נניח שהיה 70,70,70,80,90,90,90. אז סכום 560, ממוצע 80).</p>
                            <p>לפי הנתונים המקוריים, נסדר: <span class="data-list">70, 70, 70, 80, 90, 90, 100</span>.</p>
                            <p>חציון: האיבר האמצעי (הרביעי) הוא 80.</p>
                            <p>שכיח: הציון 70 מופיע 3 פעמים (הכי הרבה). השכיח הוא 70.</p>
                            <p><em>(הערה: אם התשובה הצפויה לממוצע היא 80, יש לשנות את אחד הנתונים, למשל, שה-100 יהיה 90, ואז הסכום 560).</em></p>
                            <p><strong>בהנחה שהתשובות הן: ממוצע=80, חציון=80, שכיח=70. נתאים את הנתונים לדוגמה: 70, 70, 70, 80, 90, 90, 90</strong></p>
                             <p>סכום: <span class="formula-box" dir="ltr">\(70 \cdot 3 + 80 + 90 \cdot 3 = 210 + 80 + 270 = 560\)</span>. ממוצע: <span class="formula-box" dir="ltr">\(\frac{560}{7} = 80\)</span>.</p>
                             <p>סדרה: 70,70,70,<strong>80</strong>,90,90,90. חציון: 80.</p>
                             <p>שכיח: 70 ו-90 (שניהם מופיעים 3 פעמים). אם נדרש שכיח יחיד, נשנה את הנתונים כך ש-70 יהיה השכיח.</p>
                             <p><strong>נתונים מתוקנים לפתרון: 70, 70, 70, 80, 90, 90, 100 (כמו במקור)</strong></p>
                             <p>ממוצע: <span class="formula-box" dir="ltr">\(\frac{570}{7} \approx 81.43\)</span>.</p>
                             <p>חציון: 80.</p>
                             <p>שכיח: 70.</p>
                             <p><strong>התשובה המקורית ב-JS היא {mean: '80', median: '80', mode: '70'}. כדי שזה יתאים, הנתונים צריכים להיות כאלה שהממוצע הוא 80. לדוגמה: 70, 70, 70, 80, 80, 90, 100. סכום: 560. ממוצע 80. חציון 80. שכיח 70.</strong></p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="test-yourself" aria-labelledby="test-heading" class="mb-12">
                 <h2 id="test-heading" class="text-2xl font-semibold text-blue-600 mb-4 border-b-2 border-blue-200 pb-2">בחן את עצמך 🧐</h2>
                <div class="space-y-6">
                    <div class="quiz-question p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="font-medium">שאלה 1: מהו הממוצע של המספרים: 2, 4, 6, 8, 10?</p>
                        <div class="mt-2 space-y-1">
                            <label class="flex items-center"><input type="radio" name="q1" value="a" class="ml-2"> 5</label>
                            <label class="flex items-center"><input type="radio" name="q1" value="b" class="ml-2"> 6</label>
                            <label class="flex items-center"><input type="radio" name="q1" value="c" class="ml-2"> 7</label>
                            <label class="flex items-center"><input type="radio" name="q1" value="d" class="ml-2"> 30</label>
                        </div>
                    </div>
                    <div class="quiz-question p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="font-medium">שאלה 2: מהו החציון של רשימת הציונים: 60, 90, 70, 100, 80?</p>
                        <div class="mt-2 space-y-1">
                            <label class="flex items-center"><input type="radio" name="q2" value="a" class="ml-2"> 70</label>
                            <label class="flex items-center"><input type="radio" name="q2" value="b" class="ml-2"> 80</label>
                            <label class="flex items-center"><input type="radio" name="q2" value="c" class="ml-2"> 85</label>
                            <label class="flex items-center"><input type="radio" name="q2" value="d" class="ml-2"> 90</label>
                        </div>
                    </div>
                    <button id="submit-quiz" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out">הגש בוחן</button>
                    <div id="quiz-results" class="hidden mt-3 p-3 rounded-md text-sm"></div>
                </div>
            </section>

            <section id="progress" aria-labelledby="progress-heading" class="text-center mt-12 py-8">
                 <button id="mark-completed" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                    סמן שיעור כהושלם ✅
                </button>
            </section>
        </main>

        <footer class="text-center text-gray-600 mt-12 py-4 border-t border-gray-300">
            <p>&copy; <span id="current-year"></span> פלטפורמת למידה במתמטיקה. כל הזכויות שמורות.</p>
        </footer>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, { delimiters: [{left: "$$", right: "$$", display: true}, {left: "$", right: "$", display: false}, {left: "\\(", right: "\\)", display: false}, {left: "\\[", right: "\\]", display: true}], throwOnError: false });
            document.getElementById('current-year').textContent = new Date().getFullYear();
            checkLessonStatus();
        });
        
        function showNotification(message, type = 'info', duration = 3000) {
            const notificationBox = document.getElementById('notification-box');
            if (!notificationBox) return;
            notificationBox.textContent = message;
            notificationBox.className = 'fixed top-5 right-5 text-white p-4 rounded-lg shadow-xl z-50 max-w-sm text-right'; 
            if (type === 'success') notificationBox.classList.add('bg-green-500');
            else if (type === 'error') notificationBox.classList.add('bg-red-500');
            else notificationBox.classList.add('bg-blue-500');
            notificationBox.classList.remove('hidden');
            notificationBox.style.opacity = 1;
            setTimeout(() => {
                notificationBox.style.opacity = 0;
                setTimeout(() => { notificationBox.classList.add('hidden'); }, 500);
            }, duration);
        }

        function checkStatsAnswer(exerciseId, correctAnswers) {
            const feedbackEl = document.getElementById(`feedback-${exerciseId}`);
            const userMean = document.getElementById(`${exerciseId}-mean`).value.trim();
            const userMedian = document.getElementById(`${exerciseId}-median`).value.trim();
            const userMode = document.getElementById(`${exerciseId}-mode`).value.trim();
            
            let allCorrect = true;
            let feedbackMessages = [];

            if (Math.abs(parseFloat(userMean) - parseFloat(correctAnswers.mean)) < 0.015 || userMean === correctAnswers.mean) {
                 feedbackMessages.push("ממוצע: נכון 👍");
            } else {
                allCorrect = false;
                feedbackMessages.push(`ממוצע: שגוי (תשובה: ${userMean}, נכון: ${correctAnswers.mean}) 🤔`);
            }
            if (userMedian === correctAnswers.median) {
                 feedbackMessages.push("חציון: נכון 👍");
            } else {
                allCorrect = false;
                feedbackMessages.push(`חציון: שגוי (תשובה: ${userMedian}, נכון: ${correctAnswers.median}) 🤔`);
            }
            if (userMode === correctAnswers.mode) {
                 feedbackMessages.push("שכיח: נכון 👍");
            } else {
                allCorrect = false;
                feedbackMessages.push(`שכיח: שגוי (תשובה: ${userMode}, נכון: ${correctAnswers.mode}) 🤔`);
            }
            
            feedbackEl.innerHTML = feedbackMessages.join('<br>');
            if (allCorrect) {
                feedbackEl.className = 'feedback mt-3 p-3 rounded-md text-sm bg-green-100 text-green-700';
            } else {
                feedbackEl.className = 'feedback mt-3 p-3 rounded-md text-sm bg-red-100 text-red-700';
            }
            feedbackEl.classList.remove('hidden');
        }
        
        function showSolution(solutionId) {
            const solutionEl = document.getElementById(solutionId);
            if (solutionEl) solutionEl.classList.toggle('hidden');
        }

        const quizSubmitButton = document.getElementById('submit-quiz');
        if (quizSubmitButton) {
            quizSubmitButton.addEventListener('click', function() {
                let score = 0;
                const totalQuestions = 2;
                const correctAnswers = { q1: 'b', q2: 'b' }; 
                // Q1: (2+4+6+8+10)/5 = 30/5 = 6.
                // Q2: Sorted: 60, 70, 80, 90, 100. Median is 80.
                
                const q1Answer = document.querySelector('input[name="q1"]:checked');
                if (q1Answer && q1Answer.value === correctAnswers.q1) score++;
                
                const q2Answer = document.querySelector('input[name="q2"]:checked');
                if (q2Answer && q2Answer.value === correctAnswers.q2) score++;
                
                const resultsEl = document.getElementById('quiz-results');
                resultsEl.innerHTML = `הציון שלך הוא: <strong>${score}</strong> מתוך ${totalQuestions}.`;
                resultsEl.className = 'mt-3 p-3 rounded-md text-sm bg-yellow-100 text-yellow-700';
                resultsEl.classList.remove('hidden');
                
                recordQuizScore(getLessonId(), score, totalQuestions);
                showNotification(`הבוחן הוגש! ציון: ${score}/${totalQuestions}`, 'info');
            });
        }

        function getLessonId() {
            const titleElement = document.getElementById('lesson-title');
            return titleElement ? titleElement.textContent.trim().toLowerCase().replace(/\s+/g, '_').replace(/[^\wא-ת_]+/g, '') : 'unknown_lesson';
        }
        
        const markCompletedButton = document.getElementById('mark-completed');
        if (markCompletedButton) {
            markCompletedButton.addEventListener('click', function() {
                const lessonId = getLessonId(); 
                if (lessonId === 'unknown_lesson') {
                    showNotification("שגיאה: לא ניתן היה לזהות את השיעור לסימון.", "error"); return;
                }
                markLessonAsCompleted(lessonId);
            });
        }

        function markLessonAsCompleted(lessonId) {
            try {
                localStorage.setItem(`lesson_completed_${lessonId}`, 'true');
                showNotification('השיעור סומן כהושלם!', 'success');
                if(markCompletedButton){
                    markCompletedButton.textContent = 'השיעור הושלם 👍';
                    markCompletedButton.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                    markCompletedButton.classList.add('bg-green-600', 'cursor-not-allowed');
                    markCompletedButton.disabled = true;
                }
            } catch (e) { console.error("Error accessing localStorage:", e); showNotification("שגיאה בשמירת ההתקדמות.", "error"); }
        }

        function recordQuizScore(lessonId, score, totalQuestions) {
             if (lessonId === 'unknown_lesson') { showNotification("שגיאה: לא ניתן היה לזהות את השיעור לשמירת ציון.", "error"); return; }
            try { localStorage.setItem(`lesson_quiz_score_${lessonId}`, JSON.stringify({score, totalQuestions, date: new Date().toISOString()}));
            } catch (e) { console.error("Error accessing localStorage:", e); showNotification("שגיאה בשמירת ציון הבוחן.", "error");}
        }

        function checkLessonStatus() {
            const lessonId = getLessonId();
            if (lessonId === 'unknown_lesson') return;
            try {
                const isCompleted = localStorage.getItem(`lesson_completed_${lessonId}`);
                if (isCompleted === 'true' && markCompletedButton) {
                    markCompletedButton.textContent = 'השיעור הושלם 👍';
                    markCompletedButton.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                    markCompletedButton.classList.add('bg-green-600', 'cursor-not-allowed');
                    markCompletedButton.disabled = true;
                }
            } catch (e) { console.error("Error accessing localStorage:", e); }
        }
    </script>
</body>
</html>
